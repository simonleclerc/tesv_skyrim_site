<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="Content-Language" content="en">

    <title>Poolboy - Skills</title>
    <link href="css/reset.css" media="all" rel="stylesheet"/>
    <link href="css/style.css" media="all" rel="stylesheet"/>
</head>
<body style="background-color: #000000;"class="page--skills">
<div class="header">
    <div>NAME: Simon</div>
    <div>LEVEL: 24</div>
    <div>RACE: Homo Sapiens</div>
</div>

<div class="content">
    <ul class="skills">
        <li class="skill">
            <ul class="perks">
            </ul>
            <br/>
            <span class="skill--title"><span class="skill--name">Javascript</span> <span class="skill--level"></span></span>
            <div class="skill--progress">70%</div>
        </li>
    </ul>
    <div class="desc-skill"></div>
</div>

<div class="footer">
    <div class="level">
        <span>LEVEL <span id="footer-age"></span></span>
        <svg version="1.1" id="footerBarSvg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                 width="330.036px" height="34px" viewBox="0 0 330.036 34" enable-background="new 0 0 330.036 34" xml:space="preserve">
                <defs>
                    <linearGradient id="footer_bar_gradient_color" gradientUnits="userSpaceOnUse" x1="33.1406" y1="16.9937" x2="296.8965" y2="16.9937">
                        <stop  offset="0.0106" style="stop-color:#90BBDE"/>
                        <stop  offset="0.1968" style="stop-color:#6DBBCE"/>
                        <stop  offset="0.6809" style="stop-color:#5A76A8"/>
                        <stop  offset="1" style="stop-color:#525598"/>
                    </linearGradient>
                    <linearGradient id="footer_bar_gradient_darker" gradientUnits="userSpaceOnUse" x1="165.0186" y1="26" x2="165.0186" y2="7.9878">
                        <stop  offset="0" style="stop-color:#1b282e;stop-opacity:.5"/>
                        <stop  offset="0.49" style="stop-color:#1b282e;stop-opacity:.5"/>
                        <stop  offset="0.5" style="stop-color:#000000;stop-opacity:.5"/>
                        <stop  offset=".8" style="stop-color:#1b282e;stop-opacity:.5"/>
                    </linearGradient>
                    <linearGradient id="footer_bar_gradient_lighter" gradientUnits="userSpaceOnUse" x1="165.0186" y1="26" x2="165.0186" y2="7.9878">
                        <stop  offset="0" style="stop-color:#FFFFFF;stop-opacity:0"/>
                        <stop  offset="0.49" style="stop-color:#FFFFFF;stop-opacity:0"/>
                        <stop  offset="0.5" style="stop-color:#FFFFFF;stop-opacity:.7"/>
                        <stop  offset=".8" style="stop-color:#FFFFFF;stop-opacity:0"/>
                    </linearGradient>
                </defs>
                <!-- rect full width = 263.756 -->
                <rect x="33.141" y="7.988" fill="url(#footer_bar_gradient_darker)" width="263.756" height="18.012"/>
                <rect x="33.141" y="7.988" fill="url(#footer_bar_gradient_color)" class="levelBar" width="263.756" height="18.012"/>
                <rect x="33.141" y="7.988" fill="url(#footer_bar_gradient_lighter)" class="levelBar" width="263.756" height="18.012"/>
                <path d="M330.036,17L309.212,1.006l-3.075,2.236L302.564,0H27.631l-3.643,3.307l-3.163-2.3L0,17l20.825,15.994l3.163-2.3L27.631,34
                    h274.933l3.573-3.243l3.075,2.236L330.036,17z M304.896,19.963v-5.926l0.683-0.497L309.392,17l-3.812,3.459L304.896,19.963z
                     M25.141,14.037v5.926l-0.595,0.433L20.804,17l3.741-3.396L25.141,14.037z M299.475,26H30.72l-0.124-0.112l2.544-1.851V9.963
                    l-2.544-1.851L30.72,8h268.755l0.054,0.048l-2.632,1.915v14.074l2.632,1.915L299.475,26z"/>
                <path fill="#858A89" d="M325.11,17L309.163,4.751l-3.072,2.234l-4.667-4.236H28.613l-4.667,4.236l-3.072-2.234L4.926,17
                    l15.949,12.249l3.072-2.234l4.667,4.236h272.81l4.667-4.236l3.072,2.234L325.11,17z M20.907,26.751L8.209,17l12.698-9.751
                    l1.527,1.11L12.913,17l9.521,8.641L20.907,26.751z M24.499,9.861l3.642,2.648v8.981l-3.642,2.648L16.633,17L24.499,9.861z
                     M300.458,28.75H29.579l-3.567-3.238l4.129-3.003V11.491l-4.129-3.003l3.567-3.238h270.878l3.567,3.238l-4.128,3.003v11.019
                    l4.128,3.003L300.458,28.75z M305.538,9.861L313.404,17l-7.866,7.139l-3.642-2.648v-8.981L305.538,9.861z M307.603,25.641
                    L317.124,17l-9.521-8.641l1.527-1.11L321.827,17l-12.697,9.751L307.603,25.641z"/>
            </svg>
    </div>
    <div class="localisation-date">
        <span><span id="gmap-city">Aix-en-Provence</span>, <span id="footer-date">20:49, 18 Mai, 2015</span></span>
    </div>
</div>

<script type="text/javascript" src="js/utils.js"></script>
<script type="text/javascript" src="js/jquery.custom.no-module.js"></script>
<script type="text/javascript" src="js/greensock-js/src/minified/TweenMax.min.js"></script>
<script type="text/javascript" src="js/other.js"></script>
<script type="text/javascript">
    var perks = [
        {
            title: 'Novice',
            desc: 'Write novice javascript',
            x: 5,
            y: 0,
            linkTo: [[10,1], [0,5]]
        },
        {
            title: 'Medium',
            desc: 'Write medium javascript',
            x: 0,
            y: 5
        },
        {
            title: 'Expert',
            desc: 'Write expert javascript',
            x: 10,
            y: 10
        },
        {
            title: 'Expert',
            desc: 'Write expert javascript',
            x: 10,
            y: 1,
            linkTo: [[10,10]]
        }
    ];
    var ul = document.querySelector('.perks');
    var ulH = ul.offsetHeight;
    var ulW = ul.offsetWidth;
//    TweenMax.to(ul, 0, {transform: 'rotateX(60deg) translateY(50%)'});
    var style = document.createElement('style');
    style.innerHTML = '.perks.y1 {transform: rotateX(60deg) translate3d(0,50%,0);';
    document.head.appendChild(style);

    function resizePerkToPerk () {
        var perkToPerks = document.querySelectorAll('.perkToPerk');
        for (var i = 0; i < perkToPerks.length; i++) {
            ul.removeChild(perkToPerks[i]);
        }
        perks.map(function (elm, index) {
            if (elm.linkTo) {
                elm.linkTo.map(function (elm2, index) {
                    var verticalLength = (ulH / 100) * (elm2[1] * 10 - elm.y * 10);
                    var horizontalLength = (ulW / 100) * (elm2[0] * 10 - elm.x * 10);
                    var li2 = document.createElement('li');
                    li2.classList.add('perkToPerk');
                    TweenMax.to(li2, 0, {
                        bottom: elm.y * 10 + '%',
                        left: elm.x * 10 + '%',
                        rotationZ: radToDegrees(Math.atan(horizontalLength / verticalLength)),
                        height: Math.sqrt(verticalLength * verticalLength + horizontalLength * horizontalLength)
                    });
                    ul.appendChild(li2);
                });
            }
        });
    }
    function init() {
        perks.map(function(elm, index){
            var title = document.createElement('div');
            var img = document.createElement('div');
            var desc = document.createElement('div');
            title.classList.add('perk--title');
            img.classList.add('perk--img');
            desc.classList.add('perk--desc');
            title.innerHTML = elm.title;
            desc.innerHTML = elm.desc;
            var li = document.createElement('li');
            li.classList.add('perk');
            li.setAttribute('data-x', elm.x);
            li.setAttribute('data-y', elm.y);
            li.appendChild(title);
            li.appendChild(img);
            li.appendChild(desc);
            TweenMax.to(li, 0, {bottom: elm.y * 10+'%', left: elm.x * 10+'%'});
            E.addHandler(li, 'click', function(){
                style.innerHTML = '.perks.y1 {transform: rotateX(60deg) translate3d('+ (elm.x*-10+50) +'%,'+ (elm.y*10-3) +'%,0);';
                ul.classList.add('y1');
//            ul.style.transform = 'rotate(60deg) translate3d(0, 50%, 0)';
//            TweenMax.to(ul, 1, {rotationX: 30, force3D:true});
//            TweenMax.to(ul, 1, {z: 3840/2, y: '50%', force3D:true});
//            TweenMax.to(ul, 1, {rotationX: 60, force3D:true});
            });
            ul.appendChild(li);
//        bottom: 0;
//        left: 50%;
//        height: 692px;
//        transform: rotateZ(-56deg) translateZ(1vw);
            if(elm.linkTo) {
                elm.linkTo.map(function (elm2, index) {
                    var verticalLength = (ulH/100)*(elm2[1]*10 - elm.y*10);
                    var horizontalLength = (ulW/100)*(elm2[0]*10 - elm.x*10);
                    var li2 = document.createElement('li');
                    li2.classList.add('perkToPerk');
                    TweenMax.to(li2, 0, {
                        bottom: elm.y * 10 + '%',
                        left: elm.x * 10 + '%',
                        rotationZ: radToDegrees(Math.atan(horizontalLength/verticalLength)),
                        height: Math.sqrt(verticalLength*verticalLength + horizontalLength*horizontalLength)
                    });
                    ul.appendChild(li2);
                });
            }
        });
    }
    init();

    window.onresize = function(){
        ulH = ul.offsetHeight;
        ulW = ul.offsetWidth;
        resizePerkToPerk();
    };
    setTimeout(function(){
//        TweenMax.to('.perks', 2, {rotationX: 0});
        TweenMax.to('.skill', 1, {perspective: 10000, ease: Power4.easeIn});
        TweenMax.to('.perk--title, .perk--desc, .perkToPerk',.3, { autoAlpha: 0});
        TweenMax.to('.skill', 1, {height: '4vw', width: '16vw', onComplete: function(){
            TweenMax.to('.perkToPerk',.5, { autoAlpha: 1});
            ulH = ul.offsetHeight;
            ulW = ul.offsetWidth;
            resizePerkToPerk();
        }});
    }, 500);
    $('.perk').each(function(iter, elm){
        (function(elm){
//            TweenMax.to(elm, 0, {bottom:0, $(elm).attr('e')});
        })(elm);
    });
//var perkToPerk =[
//    {from: [$('.perk').eq(0).attr('data-x'), 0, $('.perk').eq(0).attr('data-z')], to: [$('.perk').eq(1).attr('data-x')*perspectiveScale, $('.perk').eq(1).attr('data-z')/5*-(perspectiveScale*2), $('.perk').eq(1).attr('data-z')*perspectiveScale]},
//    {from: [$('.perk').eq(0).attr('data-x'), 0, $('.perk').eq(0).attr('data-z')], to: [$('.perk').eq(2).attr('data-x')*perspectiveScale, $('.perk').eq(2).attr('data-z')/5*-(perspectiveScale*2), $('.perk').eq(2).attr('data-z')*perspectiveScale]},
//    {from: [$('.perk').eq(0).attr('data-x'), 0, $('.perk').eq(0).attr('data-z')], to: [$('.perk').eq(3).attr('data-x')*perspectiveScale, $('.perk').eq(3).attr('data-z')/5*-(perspectiveScale*2), $('.perk').eq(3).attr('data-z')*perspectiveScale]}
//];
//    var vectorForce = function(vector){
//        var vectorSquareSum = 0;
//        vector.map(function(elm, index){
//            vectorSquareSum = vectorSquareSum + elm*elm;
//        });
//        return Math.sqrt(vectorSquareSum);
//    };
//    var vectorDotProduct = function(vector1, vector2){
//        var vectorDotSum = 0;
//        vector1.map(function(elm, index){
//            vectorDotSum = vectorDotSum + vector1[index]*vector2[index];
//        });
//        return vectorDotSum;
//    };
//    var vectorsAngle = function (vector1, vector2) {
//        var dot = vectorDotProduct(vector1, vector2);
//        var angle = Math.acos(dot/(vectorForce(vector1)*vectorForce(vector2)));
//        var degreeAngle = radToDegrees(angle);
//        if(dot < 0) {
//            degreeAngle = 180 - degreeAngle;
//        } else if(dot == 0) {
//            degreeAngle = 90;
//        }
//        return degreeAngle;
//    };
//    var getAngleOfRectTriangle = function(oppose, adjacent) {
//        return radToDegrees(Math.atan(oppose/adjacent));
//    }
//    perkToPerk.map(function(elm, index){
//        var perk = $('<div class="perk-to-perk"></div>');
//        $('.perks').eq(0).append(perk);
//        //transform: translate3d(0px, -269px, 0px) rotateX(68deg) rotateZ(-24deg);
//        console.log(vectorsAngle([0,1,0], (elm.to)));
//        console.log(vectorsAngle([1,0,0], (elm.to)));
//        console.log(vectorsAngle([0,0,1], (elm.to)));
////        TweenMax.to(perk, 0, {height: vectorForce(elm.to), y: -vectorForce(elm.to), rotationX: vectorsAngle([1,0,0], (elm.to)), rotationY: vectorsAngle([0,1,0], (elm.to)), rotationZ: vectorsAngle([0,0,1], (elm.to))});
//        TweenMax.to(perk, 0, {height: vectorForce(elm.to), y: -vectorForce(elm.to)});
//        console.log(elm.to[2]); //rotateY('+ vectorsAngle([1,0,0], (elm.to)) +'deg)
////        $(perk)[0].style.transform = 'translate3d(0px, -'+ vectorForce(elm.to) +'px, 0px) rotateX('+ vectorsAngle([0,1,0], (elm.to)) +'deg) rotateZ('+ (elm.to[0] < 0 ? '-':'') + (90 - vectorsAngle([0,1,0], (elm.to))) +'deg)';
//        $(perk)[0].style.transform = 'translate3d(0px, -'+ vectorForce(elm.to) +'px, 0px) rotateX('+ getAngleOfRectTriangle(elm.to[2], elm.to[1]) +'deg) rotateZ('+ ((elm.to[1]/-100) < 1 ? (((elm.to[0]/perspectiveScale)*10)/(elm.to[1]/-100)) : ((elm.to[0]/perspectiveScale)*10)/(elm.to[1]/-100)) +'deg)';
//        console.log(elm.to[0]/perspectiveScale*10);
//        console.log(elm.to[1]/-100);
//        console.log('--');
//    });
//    console.log(radToDegrees(Math.atan((5*50)/100)));
//    console.log(radToDegrees(Math.atan((-125)/269)));
</script>
</body>
</html>
